<!-- Edición de producto DB -->

<%- include('../partials/head.ejs', {cssSheet: 'productCart'}) %>

<%- include('../partials/header.ejs') %>

<script src="/js/productEdit.js"></script>

<body>
    <div class="tittleSpace">
    <h2>EDITAR PRODUCTO</h2>
    <ul class="errores">
    </ul>
    <div class="row">
        <div class="col-75">
            <div class="container">
            <form class="form" action="/products/edit/<%= Product.id %>" method="POST" enctype="multipart/form-data">
      
              <div class="row">
                <div class="col-50">
                  <h3>Datos del producto</h3>
                  <label for="nombre"><i class="fa fa-tag"></i> Nombre del Producto</label>
                  <input type="text" id="nombre" name="nombre" value= "<%= Product.product %>">
                  <label for="rate"><i class="fa fa-star"></i> Puntuación</label>
                  <input type="text" id="rate" name="rate" value= "<%= Product.rate %>">
                  <label for="precioAntes"><i class="fa fa-money-bill"></i> Precio Antes</label>
                  <input type="text" id="precioAntes" name="precioAntes" value= "<%= Product.beforePrice %>">
                  <label for="discount"><i class="fa fa-percent"></i> Descuento</label>
                  <input type="text" id="discount" name="discount" value= "<%= Product.discount %>">
                  <label for="precioAhora"><i class="fa fa-dollar-sign"></i> Precio Ahora</label>
                  <input type="text" id="precioAhora" name="precioAhora" value= "<%= Product.afterPrice %>">                  
                  <label for="descripcion"><i class="fa fa-keyboard"></i> Descripción</label>
                  <textarea name="descripcion" id="descripcion" rows="6" cols="50">  <%= Product.description %> </textarea>
                  
                  <label for="categoria"><i class="fa fa-list"></i> Categoría</label>
                    <select id="categoria" name="category">
                      <% categories.forEach(function(category) { %>
                        <option value="<%= category.id %>" <% if (category.id === Product.category.id) { %> selected <% } %>><%= category.category %></option>
                      <% }) %>
                      <option value="nueva">Agregar nueva categoría</option>
                    </select>

                    <div id="nuevaCategoriaContainer" style="display: none;">
                      <label for="nuevaCategoria"><i class="fa fa-plus"></i> Nueva Categoría</label>
                      <input type="text" id="nuevaCategoria" name="nuevaCategoria" placeholder="Ingrese una nueva categoría">
                    </div>

                    <label for="color"><i class="fa fa-palette"></i> Color</label>
                      <select id="color" name="color">
                        <% colors.forEach(function(color) { %>
                          <option value="<%= color.id %>" <% if (color.id === Product.color.id) { %> selected <% } %>><%= color.color %></option>
                        <% }) %>
                        <option value="nuevo">Agregar nuevo color</option>
                      </select>

                      <div id="nuevoColorContainer" style="display: none;">
                        <label for="nuevoColor"><i class="fa fa-plus"></i> Nuevo Color</label>
                        <input type="text" id="nuevoColor" name="nuevoColor" placeholder="Ingrese un nuevo color">
                      </div>
                    
      
                  <div class="row">
                    <div class="col-50">
                      <!-- <label for="color"><i class="fa fa-palette"></i> Color</label>
                      <input type="text" id="color" name="color" value= "<%= Product.color.color %>" required> -->
                      <!-- <label for="color"><i class="fa fa-palette"></i> Color</label>
                        <select id="color" name="color" required>
                          <% colors.forEach(function(color) { %>
                          <option value="<%= color.id %>" <% if (color.id === Product.color.id) { %> selected <% } %>><%= color.color %></option>
                          <% }) %>
                        </select> -->
                    </div>
                      <div class="col-50">
                        <label for="size"><i class="fa fa-ruler"></i> Talle</label>
                        <input type="text" id="size" name="size" value= "<%= Product.size %>">
                      </div>
                      <div class="col-50">
                        <label for="productImage"><i class="fa fa-file-import"></i> Subir Imagen</label>
                        <input id= "userImage" type="file" name="productImage" value="Editar Imagen" >
                      </div>
                  </div>
                </div>
                <div class="col-50">
                    <h3>Imagen del producto</h3>
                    <article class="articulo">
                        <img class="imagenes-addProduct" src="/images/products/<%= Product.productImage %>" alt=" ">
                    </article>
                </div>
              </div>
              
              <input type="submit" value="Editar Producto" class="btn">
            </form>
          </div>
        </div>
      </div>
  </div>
  <!-- <script>
    document.getElementById('categoria').addEventListener('change', function() {
      var nuevaCategoriaContainer = document.getElementById('nuevaCategoriaContainer');
      nuevaCategoriaContainer.style.display = (this.value === 'nueva') ? 'block' : 'none';
    });
  
    document.getElementById('color').addEventListener('change', function() {
      var nuevoColorContainer = document.getElementById('nuevoColorContainer');
      nuevoColorContainer.style.display = (this.value === 'nuevo') ? 'block' : 'none';
    });
  
    // Comprueba el estado inicial de los campos al cargar la página
    window.addEventListener('DOMContentLoaded', function() {
      var categoriaValue = document.getElementById('categoria').value;
      var nuevaCategoriaContainer = document.getElementById('nuevaCategoriaContainer');
      nuevaCategoriaContainer.style.display = (categoriaValue === 'nueva') ? 'block' : 'none';
  
      var colorValue = document.getElementById('color').value;
      var nuevoColorContainer = document.getElementById('nuevoColorContainer');
      nuevoColorContainer.style.display = (colorValue === 'nuevo') ? 'block' : 'none';
    });

    document.addEventListener("DOMContentLoaded", function () {
      const precioAntesInput = document.getElementById("precioAntes");
      const discountInput = document.getElementById("discount");
      const precioAhoraInput = document.getElementById("precioAhora");
      
      precioAntesInput.addEventListener("input", function () {
        calcularPrecioAhora();
      });

      discountInput.addEventListener("input", function () {
        calcularPrecioAhora();
      });

      function calcularPrecioAhora() {
        const precioAntes = parseFloat(precioAntesInput.value);
        const discount = parseFloat(discountInput.value);
        const precioAhora = precioAntes - (precioAntes * (discount / 100));

        if (!isNaN(precioAhora)) {
          precioAhoraInput.value = precioAhora.toFixed(2);
        }}
      });
  </script> -->
  
  
  
  <%- include('../partials/footer.ejs') %>

</body>
</html>